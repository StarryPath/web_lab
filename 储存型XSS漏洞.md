# 储存型XSS漏洞
注：此文档可以让你三分钟搞定储存型xss漏洞。

---

*第一分钟：什么是储存型xss攻击*
----------------

**Xss攻击指的是恶意攻击者向Web页面里插入恶意html代码，当用户浏览该页之时，嵌入其中Web里面的html代码会被执行，从而达到恶意攻击用户的特殊目的。
如果把恶意代码注入到服务器中，每当用户访问该页面的时候都会触发代码执行，达到持久性的攻击效果，即为储存型xss攻击。**

危害：
1、盗取各类用户帐号，如机器登录帐号、用户网银帐号、各类管理员帐号
2、控制企业数据，包括读取、篡改、添加、删除企业敏感数据的能力
3、盗窃企业重要的具有商业价值的资料
4、非法转账
5、强制发送电子邮件
6、网站挂马
7、控制受害者机器向其它网站发起攻击


----------


*第二分钟：具体案例*
---------
![此处输入图片的描述][1]
  

    这是592职业圈网显示个人资料的页面，用户编辑完成个人资料后保存在服务器中，符合储存型xss攻击的条件。

![此处输入图片的描述][2]

    找到可以插入代码的地方，这里找到可以添加专长的地方，先输入正常的数据进行测试，输入aaa。

![此处输入图片的描述][3]

    发现aaa在标签<li></li>之间，假如插入javascript代码：<script>alert(1)</script>，插入后的页面代码就变成：<li><script>alert(1)</script></li>。js代码会被执行，弹窗。

![此处输入图片的描述][4]

    这里绕过简单的过滤：&#60;script&#62;alert(1)&#60;/script&#62;
    
![此处输入图片的描述][5]

![此处输入图片的描述][6]

    查看元素可以发现，js代码成功插入，完成储存型xss攻击。

*第三分钟：防护方法*
---------

> 防护的核心是对输入(和URL参数)进行过滤，对输出进行编码。
> 也就是对提交的所有内容进行过滤，对url中的参数进行过滤，过滤掉会导致脚本执行的相关内容；然后对动态输出到页面的内容进行html编码，使脚本无法在浏览器中执行。

    如：
    < 转成 &lt;
    > 转成 &gt;
    & 转成 &amp;
    " 转成 &quot;
    ' 转成 &#39

  [1]: http://www.xfcxc.top/Adgainai4/xss1.png
  [2]: http://www.xfcxc.top/Adgainai4/xss2.png
  [3]: http://www.xfcxc.top/Adgainai4/xss3.png
  [4]: http://www.xfcxc.top/Adgainai4/xss4.png
  [5]: http://www.xfcxc.top/Adgainai4/xss5.png
  [6]: http://www.xfcxc.top/Adgainai4/xss6.png



